10 GOSUB 750:! CLS
12 CA=PEEK(-4609):! CAOS-Version
14 CH=(CA AND 240)/16
16 CL=CA AND 15
18 PRINT "System: CAOS ";CHR$(48+CH);".";CHR$(48+CL)
20 IF CH<>4 GOTO 770
30 IF CL<7 GOTO 770
32 GOSUB 960:! move.kcc (wg. Suche)
34 GOSUB 1300:! RAM-Modul suchen
36 PRINT "Schacht:";MS:PRINT "Modul: ";MO$
38 PRINT "Steuerworte:";SW(0);SW(1);SW(2);SW(3):PRINT
40 SWITCH 4,0
60 SWITCH MS,SW(0)
70 PRINT "ERDE1 wird geladen..."
80 BLOAD "ERDE1   .DAT"
90 SWITCH MS,SW(1)
100 PRINT "ERDE2 wird geladen..."
110 BLOAD "ERDE2   .DAT"
120 SWITCH MS,SW(2)
130 PRINT "ERDE3 wird geladen..."
140 BLOAD "ERDE3   .DAT"
150 SWITCH MS,SW(3)
160 PRINT "ERDE4 wird geladen..."
170 BLOAD "ERDE4   .DAT"
175 GOSUB 820:! pruefen
182 GOSUB 200
185 COLOR 7,1: SWITCH MS,0
190 END
200 CLS
202 FOR S=1 TO 300
204 XX=RND(1)*320:YY=RND(1)*256
206 PSET XX,YY,7:NEXT
210 RESTORE 320
220 SWITCH 4,0
225 AD=16096
230 FOR I=0 TO 19:!Parameter
240 READ A:POKE I+AD,A
250 NEXT I
252 POKE AD+7,MS: POKE AD+8,SW(0)
254 POKE AD+10,MS: POKE AD+11,SW(1)
256 POKE AD+13,MS: POKE AD+14,SW(2)
258 POKE AD+16,MS: POKE AD+17,SW(3)
260 CALL*3F10   :!CALC ADDR
270 CALL*3F30   :!SHOW
280 RETURN
290!
300!****** DATEN *******************
310! fuer MC ab 03EE0h
320 DATA 126   :!ZEITKONSTANTE W1=7E
330 DATA 24    :!ZEITKONSTANTE W2=18
340 DATA 11    :!FENSTER XA
350 DATA 20    :!FENSTER XE
360 DATA 15    :!FENSTER YA
370 DATA 24    :!FENSTER YE
400 DATA 4     :!ANZAHL 16K-BLOECKE
410!
420! MODULPLATZ,STEUERBYTE,SEQUENZEN
430!
440 DATA 12,67,20  :!0C,43,14
450 DATA 12,3,20   :!0C,03,14
460 DATA 12,195,20 :!0C,C3,14
470 DATA 12,131,20 :!0C,83,14
480!
490 DATA 1         :!NEUSTART AM ENDE
750 NULL0:WINDOW 0,31,0,39:PAPER 0:INK 7:CLS
760 RETURN
770 PRINT AT(5,6);"kein KC85 mit CAOS >= 4.7 !":END
820 ! Daten pruefen
830 SWITCH MS,SW(0)
840 IF DEEK(20000)<>26756 THEN 920
850 SWITCH MS,SW(1)
860 IF DEEK(20000)<>-8064 THEN 920
870 SWITCH MS,SW(2)
880 IF DEEK(20000)<>24704 THEN 920
890 SWITCH MS,SW(3)
900 IF DEEK(20000)<>24707 THEN 920
910 RETURN
920 PRINT:PRINT "ERDEx.DAT fehlerhaft geladen!"
940 PRINT:SWITCH MS,0
950 END
960 PRINT "MOVE wird generiert...":PRINT
970 RESTORE 990:! MC ab 03E00h
980 FOR I=0 TO 313:READ A:POKE I+15872,A:NEXT I:RETURN
990 DATA 58,228,62,95,58,229,62,147,60,50,214,62,58,226,62,23
1000 DATA 23,23,87,58,227,62,23,23,23,146,198,8,50,213,62,71
1010 DATA 42,217,62,213,229,235,205,3,240,52,235,225,115,35,114,35
1020 DATA 209,28,16,239,201,42,219,62,78,35,197,70,35,14,128,126
1030 DATA 35,237,121,193,70,35,17,0,64,237,83,215,62,229,197,205
1040 DATA 129,62,193,225,216,16,246,13,32,224,126,183,32,215,201,42
1050 DATA 217,62,58,214,62,71,58,213,62,79,94,35,86,35,229,42
1060 DATA 215,62,235,197,6,0,237,176,193,235,34,215,62,225,16,234
1070 DATA 201,42,217,62,58,214,62,71,58,213,62,79,94,35,86,35
1080 DATA 229,42,215,62,197,6,0,237,176,193,34,215,62,225,16,236
1090 DATA 33,224,62,70,35,78,43,221,203,8,70,40,22,58,253,1
1100 DATA 221,203,8,134,254,3,55,200,214,8,205,202,62,35,61,205
1110 DATA 202,62,43,13,32,225,16,220,183,201,32,5,52,192,53,40
1120 DATA 251,61,40,250,201,80,10,224,85,96,63,230,62,0,0,0
1130 DATA 126,24,11,20,15,24,4,12,67,20,12,3,20,12,195,20
1140 DATA 12,131,20,1,0,0,0,0,0,0,0,0,0,0,0,0
1150 DATA 245,197,58,255,62,71,14,128,237,120,50,255,62,193,241,201
1160 DATA 205,24,240,205,0,62,205,27,240,201,0,0,0,0,0,0
1170 DATA 205,24,240,205,95,62,205,27,240,201,0,0,0,0,0,0
1180 DATA 205,24,240,205,53,62,205,27,240,201
1300!
1310!****** Modul suchen *************
1320! 246=M011, 119=M032 (64k), 120=M036, 121=M032 (256k), 122=M034
1325 PA=16127:! Parameter
1330 FOR MS=8 to 255
1340 POKE PA,MS:! Modulschacht
1350 CALL*3F00:! Strukturbyte
1360 SB=PEEK(PA):! einlesen
1370 IF SB=255 GOTO 1390
1380 IF SB=119 THEN MO$="M032":GOSUB 1520:RETURN
1382 IF SB=120 THEN MO$="M036":GOSUB 1520:RETURN
1384 IF SB=121 THEN MO$="M032":GOSUB 1520:RETURN
1386 IF SB=122 THEN MO$="M034":GOSUB 1520:RETURN
1388 IF SB=246 THEN MO$="M011":GOSUB 1510:RETURN
1390 NEXT
1400 PRINT "Fehler: kein Speichermodul"
1410 PRINT "(M011/M032/M034/M036) gefunden!":END
1500! Steuerworte fuer M011
1510 SW(0)=67:SW(1)=3:SW(2)=195:SW(3)=131:RETURN
1520! Steuerworte fuer M032/64k, M036, M032/256k, M034
1530 SW(0)=3:SW(1)=7:SW(2)=11:SW(3)=15:RETURN
